## Практическая работа 4: Создание пайплайна GitLab CI для приложения Flask

GitLab CI позволяет создавать пайплайны, которые автоматизируют процесс сборки, тестирования и развертывания вашего приложения. В этом задании вы создадите пайплайн GitLab CI для вашего приложения Flask "Hello, World!" из первой практической работы

**Шаги:**

1. Создайте новый файл `.gitlab-ci.yml` в корневой директории вашего проекта.

2. Определите три стадии для вашего пайплайна: `build`, `test` и `deploy`.

```yaml
stages:
  - build
  - test
  - deploy
```

3. Добавьте задачу `build` в стадию `build`. Эта задача будет создавать Docker образ из вашего приложения.

```yaml
build:
  stage: build
  script:
    - docker build -t hello_world .
  only:
    - main
```

4. Добавьте задачу `test` в стадию `test`. Эта задача будет запускать ваше приложение и проверять, что оно корректно отвечает на HTTP запросы.

```yaml
test:
  stage: test
  script:
    - docker run -d -p 5050:5000 --name=flask_app hello_world
    - sleep 5
    - curl --retry 5 http://localhost:5050
  after_script:
    - docker stop flask_app
    - docker rm flask_app
  only:
    - main
```

5. Добавьте задачу `deploy` в стадию `deploy`. Эта задача фактически ничего не выполняет. Она нужна лишь для понимания что стадия запустилась, но потенциально конечно может заниматься деплоем на какой-либо сервер

```yaml  
deploy:
  stage: deploy
  script:
    - echo "Deploy to production server"
  when: manual
```
6. Вы можете запустить этот пайплайн с помощью shared runner'ов в Gitlab либо с помощью собственного runner'a ([инструкция по установке](https://docs.gitlab.com/runner/install/)) выбрав в качестве executor'а `shell`

**Вопросы для проверки:**

1. Что делает файл `.gitlab-ci.yml`?
2. Что означает стадия `build` в этом пайплайне?
3. Что проверяет стадия `test` в этом пайплайне?
4. Что происходит на стадии `deploy` в этом пайплайне?
5. Что означает `only: - main` в первом стейдже?
6. Что означает `when: manual` в стейдже `build`? Как это может быть полезно?
7. Как можно доработать пайплайн, для выполнения реального билда приложения и деплоя на сервер